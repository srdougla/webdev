<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="style.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pet Store</title>
</head>
<body>
    <header class="navbar">
        <div class="logo-section">
            <img src="images/pawprint.jpg" alt="Logo" class="logo">
            <h1>My Virtual Pet</h1>
        </div>

        <nav class="menu">
            <a href="index.html">Home</a>
            <a href="shelter.html">Animal Shelter</a>
            <a href="pet.html">My Pet</a>
            <a href="store.html">Pet Store</a>
        </nav>        
    </header>

    <h1>Pet Store!</h1>

    <div class="wallet">
        <h3>Account Balance:</h3>
        <h4 id="balance">$0.00</h4>

    </div>

    <div class="tabs">
        <h2>Products:</h2>
        <button class="tablinks" onclick = "openProduct(event, 'Food')">Food</button>
        <button class="tablinks" onclick = "openProduct(event, 'Toys')">Toys</button>
        <button class="tablinks" onclick = "openProduct(event, 'Treats')">Treats</button>
    </div>

    <div id="Food" class="tabcontent">
        <h1 style="text-align: center; text-decoration:underline; text-decoration-style:wavy">Food</h1>
        <div class="productContainer">
            <p><img src="images/dogfood.jpg"></p>
            <div class="productDetails">
                <p>Price: $4.00</p>
                <p class="buyButton" onclick="buy('food', 4)">Purchase</p>
            </div>
        </div>
    </div>

    <div id="Treats" class="tabcontent">
        <h1 style="text-align: center; text-decoration:underline; text-decoration-style:wavy">Treats</h1>
        <div class="productContainer">
            <p><img src="images/pettreats.jpg"></p>
            <div class="productDetails">
                <p>Price: $5.00</p>
                <p class="buyButton" onclick="buy('treats', 5)">Purchase</p>
            </div>
        </div>
    </div>

    <div id="Toys" class="tabcontent">
        <h1 style="text-align: center; text-decoration:underline; text-decoration-style:wavy">Toys</h1>
        <div class="productContainer">
            <p><img src="images/pettoys.png"></p>
            <div class="productDetails">
                <p>Price: $8.00</p>
                <p class="buyButton" onclick="buy('toys', 8)">Purchase</p>
            </div>
        </div>
    </div>

    <div id="popup" class="purchase-popup"></div>

    <div class="inventory">
        <p class="invItem">Food:<br><a id="foodAmt">0</a> scoops</p>
        <p class="invItem">Treats:<br><a id="treatAmt">0</a> treats</p>
        <p class="invItem">Toys:<br><a id="toyAmt">0</a> toys</p>
    </div>

    <script>
        // localStorage.removeItem("balance");

        function openProduct(evt, type) {

            var i, tabcontent, tablinks;
            tabcontent = document.getElementsByClassName("tabcontent");
            
            // Get all elements with class="tabcontent" and hide them
            tabcontent = document.getElementsByClassName("tabcontent");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }

            // Get all elements with class="tablinks" and remove the class "active"
            tablinks = document.getElementsByClassName("tablinks");
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" active", "");
            }

            // Show the current tab, and add an "active" class to the button that opened the tab
            document.getElementById(type).style.display = "block";
            evt.currentTarget.className += " active";
        }

        // initialize starting balance and variables
        let balance = parseFloat(localStorage.getItem("balance")) || 50;
        document.getElementById("balance").innerText = `$${balance.toFixed(2)}`;

        let food = parseInt(localStorage.getItem("food")) || 0;
        let toys = parseInt(localStorage.getItem("toys")) || 0;
        let treats = parseInt(localStorage.getItem("treats")) || 0;

        function buy (type,num) {
            num = parseFloat(num);

            if (balance - num < 0) {
                // 3 second popup indicating insufficient funds
                showPopup("Insufficient funds! You are broke!", "red");
            } else {
                balance -= num;
                document.getElementById("balance").innerText = `$${balance.toFixed(2)}`;
                localStorage.setItem("balance", balance);
                // 2 second popup to indicate successful purchase
                showPopup("Purchase successful!", "green");

                // increment product type variables
                if (type === "food") {
                    food++;
                    localStorage.setItem("food", food);
                    document.getElementById("foodAmt").innerText = food;
                } else if (type === "toys") {
                    toys++;
                    localStorage.setItem("toys", toys);
                    document.getElementById("toyAmt").innerText = toys;
                } else if (type === "treats") {
                    treats++;   
                    localStorage.setItem("treats", treats);
                    document.getElementById("treatAmt").innerText = treats;
                }
            }
        }

        function showPopup (message, color) {
            const popup = document.getElementById("popup");
            popup.innerText = message;
            popup.style.backgroundColor = color;
            popup.classList.add("show");

            // make it fade away after 3s
            setTimeout(() => {
                popup.classList.remove("show");
            }, 3000);
            

        }
        

    </script>

    <footer>
        <p style="text-align:center; padding:7%"><em>My Virtual Pet.</em> Est. October 2025 by Shannon Douglas.</p>
    </footer>

</body>
</html>